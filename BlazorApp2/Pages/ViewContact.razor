@page "/viewcontact/{id:int}"
@using BlazorApp2.Services
@using ClassLibrary1.DTOs
@inject ContactService contactService
@inject NavigationManager NavigationManager

<div class="container my-5">
    @if (contact == null)
    {
        <div class="d-flex justify-content-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    }
    else
    {
        <div class="card shadow-lg">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0">@contact.FirstName @contact.LastName</h3>
            </div>
            <div class="card-body">
                <h5 class="card-title">Contact Information</h5>
                @if (contact.Addresses != null && contact.Addresses.Any())
                {
                    <div class="row">
                        @foreach (var addr in contact.Addresses)
                        {
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6 class="card-subtitle mb-2 text-muted">Address</h6>
                                        <p class="card-text">
                                            <strong>Street:</strong> @addr.Street<br />
                                            <strong>City:</strong> @addr.City<br />
                                            <strong>State:</strong> @addr.State<br />
                                            <strong>ZIP:</strong> @addr.ZipCode
                                        </p>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <p>No addresses available.</p>
                }
            </div>
            <div class="card-footer text-end">
                <button class="btn btn-outline-secondary" @onclick="BackToContacts">
                    Back to Contacts
                </button>
            </div>
        </div>
    }
</div>

@code {
    [Parameter]
    public int id { get; set; }

    private ContactDTO contact;

    protected override async Task OnInitializedAsync()
    {
        contact = await contactService.GetContactById(id);
    }

    private void BackToContacts()
    {
        NavigationManager.NavigateTo("/contacts");
    }
}
